# Railway Environment Variables Template
# Copy this file and configure for your Railway deployment

# ==============================================================================
# DATABASE (Automatically provided by Railway PostgreSQL service)
# ==============================================================================
# Railway will automatically inject DATABASE_URL when you add a PostgreSQL service
# Format: postgresql+asyncpg://user:password@host:port/database
DATABASE_URL=postgresql+asyncpg://user:password@host:5432/stories

# ==============================================================================
# OPENAI API CONFIGURATION (Required)
# ==============================================================================
OPENAI_API_KEY=sk-your-openai-api-key-here

# Models for different tasks
OPENAI_MODEL=gpt-4o-mini
OPENAI_PREMISE_MODEL=gpt-4o-mini
OPENAI_EVAL_MODEL=gpt-4o-mini

# Token limits for generation
OPENAI_MAX_TOKENS_CHAPTER=2000
OPENAI_MAX_TOKENS_PREMISE=1500
OPENAI_MAX_TOKENS_EVAL=800

# Temperature settings (0.0-2.0, higher = more creative)
OPENAI_TEMPERATURE_CHAPTER=1.0
OPENAI_TEMPERATURE_PREMISE=1.2
OPENAI_TEMPERATURE_EVAL=0.3

# ==============================================================================
# STORY GENERATION PARAMETERS
# ==============================================================================
# Time between chapter generations (seconds)
CHAPTER_INTERVAL_SECONDS=300

# How often to evaluate story quality (every N chapters)
EVALUATION_INTERVAL_CHAPTERS=3

# Worker check interval (seconds)
WORKER_TICK_INTERVAL=15

# Active story pool size
MIN_ACTIVE_STORIES=3
MAX_ACTIVE_STORIES=5

# Story context and limits
CONTEXT_WINDOW_CHAPTERS=5
SUMMARY_REFRESH_INTERVAL_CHAPTERS=3
SUMMARY_CONTEXT_CHAPTERS=12
MAX_CHAPTERS_PER_STORY=50
MIN_CHAPTERS_BEFORE_EVAL=3

# Chaos parameter ranges (0.0 - 1.0)
CHAOS_INITIAL_MIN=0.05
CHAOS_INITIAL_MAX=0.25
CHAOS_INCREMENT_MIN=0.02
CHAOS_INCREMENT_MAX=0.15

# ==============================================================================
# QUALITY EVALUATION WEIGHTS (Must sum to 1.0)
# ==============================================================================
QUALITY_SCORE_MIN=0.6
COHERENCE_WEIGHT=0.35
NOVELTY_WEIGHT=0.25
ENGAGEMENT_WEIGHT=0.25
PACING_WEIGHT=0.15

# ==============================================================================
# PREMISE PROMPT DYNAMICS
# ==============================================================================
PREMISE_PROMPT_REFRESH_INTERVAL=6
PREMISE_PROMPT_STATS_WINDOW=12
PREMISE_PROMPT_VARIATION_STRENGTH=0.65

# ==============================================================================
# LOGGING CONFIGURATION
# ==============================================================================
LOG_LEVEL=INFO
LOG_DIR=/app/logs
LOG_MAX_BYTES=5000000
LOG_BACKUP_COUNT=5

# ==============================================================================
# FEATURE FLAGS
# ==============================================================================
ENABLE_WEBSOCKET=true

# ==============================================================================
# ADMIN AUTHENTICATION (Required)
# ==============================================================================
# Admin username for protected endpoints
ADMIN_USERNAME=admin

# Admin password (will be hashed automatically on startup)
ADMIN_PASSWORD=change-this-to-a-strong-password

# Or provide a pre-hashed bcrypt password (if set, ADMIN_PASSWORD is ignored)
# ADMIN_PASSWORD_HASH=

# Session secret for cookie signing (MUST be random and secure in production)
SESSION_SECRET=change-this-to-a-random-string-at-least-32-chars-long

# Session lifetime (seconds, default: 1 week)
SESSION_TTL_SECONDS=604800

# Session cookie configuration
SESSION_COOKIE_NAME=novellone_session
# SESSION_COOKIE_DOMAIN= (leave blank for default)

# IMPORTANT: Set to true for HTTPS in production (Railway uses HTTPS)
SESSION_COOKIE_SECURE=true

# Cookie SameSite policy (lax, strict, or none)
SESSION_COOKIE_SAMESITE=lax

# ==============================================================================
# RAILWAY-SPECIFIC URLS (Set these in Railway dashboard)
# ==============================================================================
# Backend URL (set to your Railway backend public URL)
# Example: https://your-backend-production.up.railway.app
PUBLIC_API_URL=https://your-backend.railway.app

# Frontend environment variables (set in Railway frontend service)
# VITE_PUBLIC_API_URL should point to backend public URL
# Example: https://your-backend-production.up.railway.app
VITE_PUBLIC_API_URL=https://your-backend.railway.app

# WebSocket URL (wss:// for HTTPS, ws:// for HTTP)
# Example: wss://your-backend-production.up.railway.app/ws/stories
VITE_PUBLIC_WS_URL=wss://your-backend.railway.app/ws/stories

# Frontend ORIGIN (set to your Railway frontend public URL)
# Example: https://your-frontend-production.up.railway.app
ORIGIN=https://your-frontend.railway.app

# ==============================================================================
# PORT CONFIGURATION (Automatically set by Railway)
# ==============================================================================
# Railway automatically provides PORT - no need to set manually
# PORT=8000 (backend)
# PORT=3000 (frontend)

